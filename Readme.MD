# Assessment Guide Compiler

A python script that consolidates multiple *Assessment Guide* workbooks into a single master sheet that serves as the primary data source for the powerbi report.

---

## âœ¨ Features

* Ingests every workbook in an `assessment_guide` folder.
* **Column sanityâ€‘checks** against a *Column Reference* file, with warnings for duplicates or missing fields.
* **Glossary tab** kept on a separate tab. Definitions used to explain terminology on dashboard.
* **Config file** â€“ point the script to filenames or folders necessary for consolidation by editing the config.yaml file.

---

## ğŸ—‚ï¸ Folder Structure

```
repo_root/
â”œâ”€ main.py   â† the script used to compile the assessment guide workbooks
â”œâ”€ config.yaml                    â† runâ€‘time settings (see below)
â”œâ”€ requirements.txt               â† Python dependencies file
â”œâ”€ README.md                      â† this file
â”œâ”€ master_sheet_reference.xlsx    â† authoritative list of tables & columns
â”œâ”€ assessment_guides/             â† **folder** containing Assessment Guide excel workbooks, e.g.
â”‚  â”œâ”€ assessment_guide_qiddiya.xlsx
â”‚  â”œâ”€ assessment_guide_diriyah.xlsm
â”‚  â””â”€ ...
â””â”€ master_sheet.xlsx/             â† **output** fle
```

---

## âš™ï¸ Configuration

`config.yaml` drives everything. A minimal example:

```yaml
# config.yaml
column_reference_file_name: "master_sheet_reference.xlsx"
assessment_guide_folder_name: "assessment_guide"   # folder
compiled_master_sheet: "master_sheet.xlsx"
```

* **`column_reference_file_name`** â€“ excel file where each sheet refers to a dash in the report and contains the *Table* and *Column* lists for data extraction from the assessment guide files.
* **`assessment_guide_folder_name`** â€“ directory containing one workbook per DevCo (must start with `assessment_guide_`).
* **`compiled_master_sheet`** â€“ output file name.
---

## ğŸ¤– How It Works (Highâ€‘level Flow)

```text
load_config() â†’ read YAML
   â†“
scan master_sheet_reference.xlsx
   â†“
for each Assessment Guide workbook
       â€¢ validate & rename columns
       â€¢ collect subset of columns per reference table
   â†“
concat columns for each DevCo horizontally (column-wise) and data for each DevCo vertically (row-wise)
   â†“
write master sheet + Glossary tab
```

---